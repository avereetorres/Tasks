births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
xvar <- log(sapply(trees, Ntip))
yvar <- (births[[i]]-(births[[i]]*Fractions[[i]]))
length(xvar)
length(yvar)
length(xvar) = length(yvar)
length(xvar) = length(yvar)
length(xvar) == length(yvar)
for (i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
xvar <- log(sapply(trees, Ntip))
yvar <- (births[[i]]-(births[[i]]*Fractions[[i]]))
plot2 <- plot(xvar, yvar)
}
plot2 <- plot(xvar, yvar)
length(xvar) == length(yvar)
length(xvar) == length(yvar)
plot(trees[[i]])
logs <- log(sapply(trees, Ntip))
length(xvar) == length(yvar)
plot(trees[[i]])
length(xvar) == length(yvar)
length(xvar) == length(yvar)
length(xvar) == length(yvar)
length(xvar) == length(yvar)
xvar <- log(sapply(trees, Ntip))
yvar <- (births[[i]]-(births[[i]]*Fractions[[i]]))
length(xvar) == length(yvar)
xvar <- log(sapply(trees, Ntip))
yvar <- (births[[i]]-(births[[i]]*Fractions[[i]]))
length(xvar) == length(yvar)
length(xvar) == length(yvar)
length(xvar) == length(yvar)
length(xvar) == length(yvar)
logs <- log(sapply(trees, Ntip))
netdiv <- (0.9966854-extrate)
plot(logs, netdiv)
e-rate <- births * Fractions
extrate <- births * Fractions
netdiv <- (births - extrate)
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(logs, netdiv, xlab="log of tips", ylab="net diversification")
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(netdiv ~ logs)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(netdiv ~ logs)
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(lm(netdiv ~ logs))
abline(lm(netdiv ~ logs))
abline(lm(logs~netdiv))
cor.test(logs~netdiv)
cor.test(logs, netdiv)
abline(lm(logs~netdiv), col="red")
logs <- log(sapply(trees, Ntip))
?edge.length
library("phytools")
?edge.length
#Question 5
avgbranchlength <- vector()
avgbranchlength[[i]] <- mean(trees$length)
avgbranchlength[[i]] <- mean(trees$edge.length)
avgbranchlength[[i]] <- mean(trees$length)
avgbranchlength[[i]] <- mean(trees[[i]]$edge.length)
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
avgbranchlength <- vector()
for(i in 100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[[i]] <- mean(trees[[i]]$edge.length)
}
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
mean(trees[[i]]$edge.length)
avgbranchlength[[i]]
births
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
?unlist
#Question 6
cor(births, avgbranchlength)
avgbranchlength
avgbranchlength[[i]] <- mean(trees[[i]]$edge.length)
avgbranchlength
rates <- vector()
traits <- list()
?pbtree
library("phytools")
#Questions 1-3
trees <- list()
births <- vector()
Fractions <- vector()
?pbtree
logs <- log(sapply(trees, Ntip))
library("phytools")
#Questions 1-3
trees <- list()
births <- vector()
Fractions <- vector()
?pbtree
for (i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
}
trees[[i]]
?tiplabels
?Ntip.multiPhylo
?Ntip
?Ntip.phylo
extrate <- births * Fractions
#Question 4
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(lm(logs~netdiv), col="red")
avgbranchlength
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
avgbranchlength2 <- unlist(avgbranchlength)
plot(births, avgbranchlength2, xlab="speciation rate", ylab="average branch length")
avgbranchlength2
#Question 5
avgbranchlength <- list()
for(i in 100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[[i]] <- mean(trees[[i]]$edge.length)
}
avgbranchlength2 <- unlist(avgbranchlength)
plot(births, avgbranchlength2, xlab="speciation rate", ylab="average branch length")
?averageTree
avgbranchlength <- vector()
for(i in 100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[[i]] <- averageTree(trees[[i]]$edge.length)
}
avgbranchlength <- vector()
for(i in 100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[[i]] <- mean(trees[[i]]$edge.length)
}
avgbranchlength2 <- unlist(avgbranchlength)
avgbranchlength2 <- unvector(avgbranchlength)
?unlist
?unlist
?unlist
avgbranchlength
avgbranchlength <- vector()
for(i in 100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[i] <- mean(trees[[i]]$edge.length)
}
avgbranchlength
avgbranchlength2 <- unlist(avgbranchlength)
for(i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[i] <- mean(trees[[i]]$edge.length)
}
avgbranchlength
plot(births, avgbranchlength2, xlab="speciation rate", ylab="average branch length")
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
cor(births, avgbranchlength)
?which
?which
#Question 7
Tree <- max(sapply(trees, Ntip))
Tree
rates <- vector()
traits <- list()
Tree
for(i in 100){
rates[[i]] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[[i]])
}
?fastBM
for(i in 100){
rates[[i]] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[[i]], n=100)
}
for(i in 1:100){
rates[i] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[i])
}
?which
which(trees, Ntip=max)
which(trees, Ntip=1100)
which(trees$Ntip=1100)
Tree <- which.max(sapply(trees, Ntip))
Tree
Tree <- which.max(sapply(trees, Ntip))
Tree
Tree <- (trees, row = 95)
Tree <- (trees$row = 95)
Tree
plot(Tree)
Tree <- (trees$column = 95)
Tree
Tree <- max(sapply(trees, Ntip))
Tree <- which.max(sapply(trees, Ntip))
Tree <- max(sapply(trees, Ntips))
Tree <- max(sapply(trees, Ntip))
trees
Tree <- which(max(sapply(trees, Ntip)))
Tree <- max(sapply(trees, Ntip))
Tree <- max(sapply(trees, Ntip))
library("phytools")
#Questions 1-3
trees <- list()
births <- vector()
Fractions <- vector()
?pbtree
for (i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
}
trees[[i]]
?tiplabels
?Ntip.multiPhylo
?Ntip
?Ntip.phylo
extrate <- births * Fractions
#Question 4
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(lm(logs~netdiv), col="red")
#There is a positive correlation between the log of the number of tips and net diversification rate
?length
?averageTree
#Question 5
avgbranchlength <- vector()
for(i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[i] <- mean(trees[[i]]$edge.length)
}
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
#Question 6
cor(births, avgbranchlength)
#There is a negative correlation between speciation rate and average branch length
?which
#Question 7
which(trees$Ntips=)
Tree <- max(sapply(trees, Ntip))
rates <- vector()
traits <- list()
Tree
for(i in 1:100){
rates[i] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[i])
}
Tree <- which.max(sapply(trees, Ntip))
Tree
Tree <- Tree[16]
Tree
Tree <- trees[16]
Tree
Tree <- trees
which.max(sapply(Tree, Ntip))
Tree <- trees[[Tree]]
which.is.max(sapply(Tree, Ntip))
MTree <- which.is.max(sapply(Tree, Ntip))
MTree <- which.is.max(sapply(trees, Ntip))
Tree <- trees[[MTree]]
which.is.max
?which.is.max
MTree <- which.is.max(sapply(trees, Ntip))
MTree <- which.max(sapply(trees, Ntip))
Tree <- trees[[MTree]]
plot(Tree)
for(i in 1:100){
rates[i] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[i])
}
meantraits <- mean(traits)
cor(meantraits, rates)
meantraits <- mean(traits)
meantraits <- mean(traits)
#Question 8
untrait <- unlist(traits)
meantraits <- mean(untrait)
cor(meantraits, rates)
cor(rates, meantraits)
cor(rates, meantraits)
meantraits <- sapply(mean, traits)
cor(meantraits, rates)
meantraits <- sapply(traits, mean)
cor(meantraits, rates)
plot(meantraits, rates, xlab="Mean of Traits", ylab="Rates")
abline(lm(meantraits~rates))
abline(lm(meantraits~rates), col="red")
#Question 9
vartraits <- sapply(var, mean)
#Question 9
vartraits <- sapply(traits, var)
cor(vartraits, rates)
#Question 10
traits1 <- trait[1]
#Question 10
traits1 <- traits[1]
traits2 <- traits[2]
cor(traits1, traits2)
cor(traits2, traits1)
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
plot(traitMat, xlab="Trait 1", ylab="Trait 2")
str(traits)
traitMat <- cbind(traits[[10]], traits[[24]])
plot(traitMat, xlab="Trait 1", ylab="Trait 2")
cor(traitMat)
cor(traitMat[,1], traitMat[,2])
cor.test(traitMat[,1], traitMat[,2])
cor.test(traitMat[,1], traitMat[,2])$p.value
traitMat <- cbind(traits[[13]], traits[[7]])
plot(traitMat, xlab="Trait 1", ylab="Trait 2")
cor.test(traitMat[,1], traitMat[,2])$p.value
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat, xlab="Trait 1", ylab="Trait 2")
cor.test(traitMat[,1], traitMat[,2])$p.value
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat, xlab="Trait 1", ylab="Trait 2")
cor.test(traitMat[,1], traitMat[,2])$p.value
abline(lm())
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
cor.test(traitMat[,1], traitMat[,2])$p.value
dev.off()
dev.off()
dev.off()
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
cor.test(traitMat[,1], traitMat[,2])$p.value
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
cor.test(traitMat[,1], traitMat[,2])$p.value
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
cor.test(traitMat[,1], traitMat[,2])$p.value
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
cor.test(traitMat[,1], traitMat[,2])$p.value
dev.off()
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
dev.off()
#BONUS
phylomorphospace(traits[[24]], traits[[50]], trees)
?phylomorphospace
phylomorphospace(Tree, traits[[24]], traits[[50]])
library("phytools")
#Questions 1-3
trees <- list()
births <- vector()
Fractions <- vector()
?pbtree
for (i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
}
trees[[i]]
?tiplabels
?Ntip.multiPhylo
?Ntip
?Ntip.phylo
extrate <- births * Fractions
#Question 4
logs <- log(sapply(trees, Ntip))
netdiv <- (births - extrate)
plot(netdiv, logs, xlab="net diversification", ylab="log of tips")
abline(lm(logs~netdiv), col="red")
#There is a positive correlation between the log of the number of tips and net diversification rate
?length
?averageTree
#Question 5
avgbranchlength <- vector()
for(i in 1:100){
births[[i]] <- runif(1)
Fractions[[i]] <- runif(1)
trees[[i]] <- pbtree(n=100, b=births[[i]], d=(births[[i]]*Fractions[i]))
avgbranchlength[i] <- mean(trees[[i]]$edge.length)
}
plot(births, avgbranchlength, xlab="speciation rate", ylab="average branch length")
#Question 6
cor(births, avgbranchlength)
#There is a negative correlation between speciation rate and average branch length
?which
#Question 7
MTree <- which.max(sapply(trees, Ntip))
Tree <- trees[[MTree]]
plot(Tree)
rates <- vector()
traits <- list()
Tree
for(i in 1:100){
rates[i] <- runif(1)
traits[[i]] <- fastBM(tree=Tree, sig2=rates[i])
}
?fastBM
#Question 8
meantraits <- sapply(traits, mean)
cor(meantraits, rates)
plot(meantraits, rates, xlab="Mean of Traits", ylab="Rates")
abline(lm(meantraits~rates), col="red")
#There is a negative correlation between the mean of traits and rates
#Question 9
vartraits <- sapply(traits, var)
cor(vartraits, rates)
#There is a positive correlation between the variance of traits and rates
#Question 10
pdf("08_plot.pdf")
traits1 <- traits[[1]]
traits2 <- traits[[2]]
cor(traits2, traits1)
traitMat <- cbind(traits[[24]], traits[[50]])
plot(traitMat)
dev.off()
cor.test(traitMat[,1], traitMat[,2])$p.value
#BONUS
phylomorphospa
dev.off()
dev.off()
#BONUS
phylomorphospace(Tree, traitMat)
plot("bonus08.pdf")
pdf("bonus08.pdf")
phylomorphospace(Tree, traitMat)
dev.off()
dev.off()
dev.off()
phylomorphospace(Tree, traitMat, scale=1)
phylomorphospace(Tree, traitMat, scale=5)
